<article>
<nz-affix class="toc-affix" [nzOffsetTop]="16">
  <nz-anchor [nzAffix]="false" nzShowInkInFixed (nzClick)="goLink($event)">
    <nz-link nzHref="#components-code-editor-demo-basic" nzTitle="基本"></nz-link><nz-link nzHref="#components-code-editor-demo-diff" nzTitle="Diff 编辑器"></nz-link><nz-link nzHref="#components-code-editor-demo-config" nzTitle="修改配置"></nz-link><nz-link nzHref="#components-code-editor-demo-full-control" nzTitle="完全受控模式"></nz-link><nz-link nzHref="#components-code-editor-demo-complex" nzTitle="复杂"></nz-link><nz-link nzHref="#api" nzTitle="API"></nz-link>
  </nz-anchor>
</nz-affix><section class="markdown">
  <h1>
	Code Editor
	<span class="subtitle">代码编辑器</span>
</h1>

  <component-meta name="code-editor" description="基于 monaco-editor 的代码编辑器。" language="zh"></component-meta>
  
<blockquote style="border-color: #faad14">
<p>NG-ZORRO 实验性功能是指已发布但不稳定或者还未准备好用于生产环境的功能。</p>
<p>开发者或用户可以选择在正式发布前使用这些功能，但是每次发布版本时都可能存在 <strong>breaking changes</strong>。</p>
</blockquote>
  <section class="markdown" ngNonBindable>
    
  </section>
  
  <h2>
    <span>代码演示</span>
    <nz-icon nzType="appstore" class="code-box-expand-trigger" nz-tooltip nzTooltipTitle="展开全部代码" (click)="expandAllCode()" />
  </h2>
</section>
<div nz-row [nzGutter]="8">
	<div nz-col [nzSpan]="24">
		<nz-code-box
  nzTitle="基本"
  [nzId]="'components-code-editor-demo-basic'"
  nzSelector="nz-demo-code-editor-basic"
  [nzLink]="'components-code-editor-demo-basic'"
  nzGenerateCommand="ng g ng-zorro-antd:code-editor-basic <name>"
  nzComponentName="NzDemoCodeEditorBasicComponent"
  [nzIframe]="false"
  nzIframeSource=""
  [nzIframeHeight]="null"
  [nzHref]="'https://github.com/NG-ZORRO/ng-zorro-antd/edit/master/components/code-editor/demo/basic.md'"
>
	<nz-demo-code-editor-basic demo />
	<div intro ngNonBindable>
		<p>最简单的用法。</p>

	</div>
</nz-code-box>
<nz-code-box
  nzTitle="Diff 编辑器"
  [nzId]="'components-code-editor-demo-diff'"
  nzSelector="nz-demo-code-editor-diff"
  [nzLink]="'components-code-editor-demo-diff'"
  nzGenerateCommand="ng g ng-zorro-antd:code-editor-diff <name>"
  nzComponentName="NzDemoCodeEditorDiffComponent"
  [nzIframe]="false"
  nzIframeSource=""
  [nzIframeHeight]="null"
  [nzHref]="'https://github.com/NG-ZORRO/ng-zorro-antd/edit/master/components/code-editor/demo/diff.md'"
>
	<nz-demo-code-editor-diff demo />
	<div intro ngNonBindable>
		<p>使用 diff 模式。</p>

	</div>
</nz-code-box>
<nz-code-box
  nzTitle="修改配置"
  [nzId]="'components-code-editor-demo-config'"
  nzSelector="nz-demo-code-editor-config"
  [nzLink]="'components-code-editor-demo-config'"
  nzGenerateCommand="ng g ng-zorro-antd:code-editor-config <name>"
  nzComponentName="NzDemoCodeEditorConfigComponent"
  [nzIframe]="false"
  nzIframeSource=""
  [nzIframeHeight]="null"
  [nzHref]="'https://github.com/NG-ZORRO/ng-zorro-antd/edit/master/components/code-editor/demo/config.md'"
>
	<nz-demo-code-editor-config demo />
	<div intro ngNonBindable>
		<p>可以在运行时修改编辑器的默认配置，和页面上编辑器的配置。</p>

	</div>
</nz-code-box>
<nz-code-box
  nzTitle="完全受控模式"
  [nzId]="'components-code-editor-demo-full-control'"
  nzSelector="nz-demo-code-editor-full-control"
  [nzLink]="'components-code-editor-demo-full-control'"
  nzGenerateCommand="ng g ng-zorro-antd:code-editor-full-control <name>"
  nzComponentName="NzDemoCodeEditorFullControlComponent"
  [nzIframe]="false"
  nzIframeSource=""
  [nzIframeHeight]="null"
  [nzHref]="'https://github.com/NG-ZORRO/ng-zorro-antd/edit/master/components/code-editor/demo/full-control.md'"
>
	<nz-demo-code-editor-full-control demo />
	<div intro ngNonBindable>
		<p>使用完全受控模式，自行管理 monaco editor 的 TextModel。</p>

	</div>
</nz-code-box>
<nz-code-box
  nzTitle="复杂"
  [nzId]="'components-code-editor-demo-complex'"
  nzSelector="nz-demo-code-editor-complex"
  [nzLink]="'components-code-editor-demo-complex'"
  nzGenerateCommand="ng g ng-zorro-antd:code-editor-complex <name>"
  nzComponentName="NzDemoCodeEditorComplexComponent"
  [nzIframe]="false"
  nzIframeSource=""
  [nzIframeHeight]="null"
  [nzHref]="'https://github.com/NG-ZORRO/ng-zorro-antd/edit/master/components/code-editor/demo/complex.md'"
>
	<nz-demo-code-editor-complex demo />
	<div intro ngNonBindable>
		<p>带加载效果和工具条的更复杂的例子。</p>

	</div>
</nz-code-box>

	</div>
</div><section class="markdown api-container" ngNonBindable><h2 id="何时使用"><span>何时使用</span><a onclick="window.location.hash = '何时使用'" class="anchor">#</a></h2><p>需要在网页上渲染 monaco editor 时使用。</p>
<h3 id="引入样式"><span>引入样式</span><a onclick="window.location.hash = '引入样式'" class="anchor">#</a></h3><pre><code class="language-less"><span class="token variable">&#64;import</span> <span class="token string">'node_modules/ng-zorro-antd/code-editor/style/entry.less'</span><span class="token punctuation">;</span>
</code></pre><h2 id="api"><span>API</span><a onclick="window.location.hash = 'api'" class="anchor">#</a></h2><p>别忘记先安装 monaco editor：</p>
<pre><code class="language-sh"><span class="token function">npm</span> <span class="token function">install</span> monaco-editor
</code></pre><h3 id="动态加载"><span>动态加载</span><a onclick="window.location.hash = '动态加载'" class="anchor">#</a></h3><p>如果你使用动态加载，你就需要在运行时加载 monaco editor 本身的资源。</p>
<p>在 <code>angular.json</code> 中添加：</p>
<pre><code class="language-diff">"assets": [
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   "glob": "**/*",
</span><span class="token prefix inserted">+</span><span class="token line">   "input": "./node_modules/monaco-editor/min/vs",
</span><span class="token prefix inserted">+</span><span class="token line">   "output": "/assets/vs/"
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;
</span></span>],
</code></pre><p>这样就 OK 了！CodeEditor 组件在需要加载 monaco editor 时自动去 <code>/assets/vs/</code> 目录下查询。</p>
<p>如果你的静态资源都部署在 CDN 上，你就无须修改 <code>angular.json</code> 文件，但你必须通过 <code>NzConfigService</code> 配置 <code>assetsRoot</code> 属性。例如你将 monaco editor 的资源放置在了 <a href="https://mycdn.com/assets/vs" target="_blank" rel="noopener">https://mycdn.com/assets/vs</a> ，你就需要传递 <code>&#123; assetsRoot: &#39;https://mycdn.com/assets&#39; &#125;</code> 。</p>
<blockquote>
<p>如果你使用静态加载，你就无需修改 <code>angular.json</code> 文件，详见下文。</p>
</blockquote>
<h3 id="静态加载"><span>静态加载</span><a onclick="window.location.hash = '静态加载'" class="anchor">#</a></h3><p>有时候你可能需要在运行时加载 AMD module，但 monaco editor 的加载文件 loader.js patch 了 <code>window[require]</code> 属性，导致你无法使用 requireJS 等模块加载库，这时，你可以启用静态加载功能。</p>
<p>方法是使用 Microsoft 提供的 <a href="https://github.com/microsoft/monaco-editor-webpack-plugin" target="_blank" rel="noopener">monaco-editor-webpack-plugin</a> 插件。</p>
<ol>
<li>在 <code>app.config.ts</code> 中提供 <code>NZ_CONFIG</code> 的值，并设置 <code>codeEditor</code> 属性下的 <code>useStaticLoading</code> 为 <code>true</code> 。</li>
<li>创建一个 webpack.partial.js 文件，根据插件文档进行相应的配置。</li>
<li>使用自定义脚本加载器，例如 <a href="https://github.com/manfredsteyer/ngx-build-plus" target="_blank" rel="noopener">ngx-build-plus</a>，在打包时加载这个 webpack 配置。</li>
</ol>
<p>使用静态加载时，你无需在 <code>angular.json</code> 文件中注册 monaco editor 的资源。</p>
<h3 id="nz-code-editor"><span>nz-code-editor</span><label class="api-type-label component">component</label><a onclick="window.location.hash = 'nz-code-editor'" class="anchor">#</a></h3><table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>类型</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td><code>[nzEditorMode]</code></td>
<td>编辑器的模式</td>
<td><code>normal</code></td>
<td><code>diff</code></td>
</tr>
<tr>
<td><code>[nzLoading]</code></td>
<td>加载中</td>
<td><code>boolean</code></td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>[nzOriginalText]</code></td>
<td>Diff 模式下，左半边的文本内容</td>
<td><code>boolean</code></td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>[nzFullControl]</code></td>
<td>完全控制模式，此模式下组件不会帮助用户处理 <code>TextModel</code>，用户应当自行管理 monaco editor 实例</td>
<td><code>boolean</code></td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>[nzEditorOption]</code></td>
<td>编辑器选项，<a href="https://microsoft.github.io/monaco-editor/api/interfaces/monaco.editor.IEditorOptions.html" target="_blank" rel="noopener">参考 monaco editor 的定义</a></td>
<td><code>IEditorConstructionOptions</code></td>
<td><code>&#123;&#125;</code></td>
</tr>
<tr>
<td><code>[nzToolkit]</code></td>
<td>暴露快捷操作</td>
<td><code>TemplateRef&lt;void&gt;</code></td>
<td>-</td>
</tr>
<tr>
<td><code>(nzEditorInitialized)</code></td>
<td>当编辑器组件初始化完毕之后派发事件</td>
<td><code>IStandaloneCodeEditor</code></td>
<td><code>IStandaloneDiffEditor</code></td>
</tr>
</tbody></table>
<h4 id="方法"><span>方法</span><a onclick="window.location.hash = '方法'" class="anchor">#</a></h4><table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>layout()</code></td>
<td>强制组件重新渲染</td>
</tr>
</tbody></table>
<h3 id="全局配置"><span>全局配置</span><a onclick="window.location.hash = '全局配置'" class="anchor">#</a></h3><p>你可以通过 <code>NzConfigService</code> 的 <code>set</code> 方法，设置 <code>CodeEditor</code> 组件的默认配置。</p>
<h4 id="codeeditorconfig"><span>CodeEditorConfig</span><a onclick="window.location.hash = 'codeeditorconfig'" class="anchor">#</a></h4><table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
<th>类型</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td><code>assetsRoot</code></td>
<td>组件加载 monaco editor 资源文件的位置</td>
<td><code>string</code></td>
<td><code>SafeUrl</code></td>
</tr>
<tr>
<td><code>defaultEditorOption</code></td>
<td>默认的编辑器设置，<a href="https://microsoft.github.io/monaco-editor/docs.html#interfaces/editor.IEditorConstructionOptions.html" target="_blank" rel="noopener">参考 monaco editor 的定义</a></td>
<td><code>IEditorConstructionOptions</code></td>
<td><code>&#123;&#125;</code></td>
</tr>
<tr>
<td><code>onLoad</code></td>
<td>当 monaco editor 资源加载完毕时触发的钩子，此时全局对象 <code>monaco</code> 可用 (monaco-editor 版本不小于 0.22.0 时需定义 <code>window.MonacoEnvironment = &#123; globalAPI: true &#125;</code>)</td>
<td><code>() =&gt; void</code></td>
<td>-</td>
</tr>
<tr>
<td><code>onFirstEditorInit</code></td>
<td>当第一个编辑器请求初始化时触发的钩子</td>
<td><code>() =&gt; void</code></td>
<td>-</td>
</tr>
<tr>
<td><code>onInit</code></td>
<td>每个编辑器请求初始化时触发的钩子</td>
<td><code>() =&gt; void</code></td>
<td>-</td>
</tr>
<tr>
<td><code>useStaticLoading</code></td>
<td>使用静态加载</td>
<td><code>boolean</code></td>
<td><code>false</code></td>
</tr>
</tbody></table>
</section></article>